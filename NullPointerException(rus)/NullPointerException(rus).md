# üî• NullPointerException: –ü–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä –¥–æ –±–∞–π—Ç–æ–≤

—á—Ç–æ —Ç–∞–∫–æ–µ null
## **–ß—Ç–æ —Ç–∞–∫–æ–µ `null` —Ñ–∏–∑–∏—á–µ—Å–∫–∏?**

`null` - —ç—Ç–æ **—á–∏—Å–ª–æ 0** –≤ –ø–∞–º—è—Ç–∏. –í—Å—ë.

```java
// –í Java
String str = null;

// –í –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
str = 0x00000000  // –ø—Ä–æ—Å—Ç–æ 32 –∏–ª–∏ 64 –±–∏—Ç–∞ –Ω—É–ª–µ–π
```

## **–ö–∞–∫ Java –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ —ç—Ç–æ `null`?**

**–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä Java –ó–ê–†–ê–ù–ï–ï –∑–Ω–∞–µ—Ç –ø—Ä–æ `null`:**

1. **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä** ‚Üí –≤–∏–¥–∏—Ç —Å–ª–æ–≤–æ `null` –≤ –∫–æ–¥–µ
2. **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä** ‚Üí –∑–∞–º–µ–Ω—è–µ—Ç –µ–≥–æ –Ω–∞ **–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é "–∑–∞–≥—Ä—É–∑–∏ 0"**
3. **JVM** ‚Üí –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é "–∑–∞–≥—Ä—É–∑–∏ 0"
4. **JVM** ‚Üí –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –ø—Ä–æ–≤–µ—Ä—è–µ—Ç "—Ä–∞–≤–Ω–æ –ª–∏ 0?"

```java
// –¢–≤–æ–π –∫–æ–¥:
String str = null;

// –ë–∞–π—Ç-–∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä:
aconst_null    // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ "–ø–æ–ª–æ–∂–∏—Ç—å null –≤ —Å—Ç–µ–∫"
astore_1       // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é str
```

## **–ì–¥–µ "–∑–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω" null?**

1. **–í –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–µ javac** (—Ñ–∞–π–ª—ã .java):
   - –ï—Å—Ç—å –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–ª–æ–≤–æ `null`
   - –ü—Ä–∏ –≤—Å—Ç—Ä–µ—á–µ ‚Üí –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–∞–Ω–¥—É `aconst_null`

2. **–í JVM** (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ):
   - –ö–æ–º–∞–Ω–¥–∞ `aconst_null` = "–ø–æ–ª–æ–∂–∏—Ç—å 0 –≤ —Å—Ç–µ–∫"
   - –ö–æ–º–∞–Ω–¥–∞ `ifnull` = "–µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ = 0, —Ç–æ..."

–ö–∞–∫ –∂–µ–ª–µ–∑–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, null —ç—Ç–æ –∏–ª–∏ 0?

`null` –≤ Java - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ **–Ω–æ–ª—å –≤ –ø–∞–º—è—Ç–∏**. –ñ–µ–ª–µ–∑–æ –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ `00000000` –∏ –Ω–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç —Ç–∏–ø—ã. 

**JVM –æ—Ç–ª–∏—á–∞–µ—Ç "0-—á–∏—Å–ª–æ" –æ—Ç "0-null" –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:** 
- –î–ª—è `int x = 0` ‚Üí –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –î–ª—è `String s = null` ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º –º–µ—Ç–æ–¥–æ–≤

## **–ò—Ç–æ–≥:**

- `null` = **–≤—Å–µ–≥–æ –ª–∏—à—å 0 –≤ –ø–∞–º—è—Ç–∏**
- **–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä** –∑–∞–º–µ–Ω—è–µ—Ç —Å–ª–æ–≤–æ `null` –Ω–∞ –∫–æ–º–∞–Ω–¥—É "–ø–æ–ª–æ–∂–∏—Ç—å 0"
- **JVM** –ø—Ä–∏ –≤–∏–¥–µ `0` –ø–æ–Ω–∏–º–∞–µ—Ç: "–æ–±—ä–µ–∫—Ç–∞ –Ω–µ—Ç" ‚Üí –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ

**–ù–∏–∫–∞–∫–æ–π –º–∞–≥–∏–∏ - –ø—Ä–æ—Å—Ç–æ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å, —á—Ç–æ 0 = –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—ä–µ–∫—Ç–∞.**

## ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ NullPointerException?
`NullPointerException` (NPE) ‚Äî —ç—Ç–æ –Ω–µ ¬´–æ—à–∏–±–∫–∞¬ª, —ç—Ç–æ **—ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ —Ç–æ—Ä–º–æ–∂–µ–Ω–∏–µ JVM** –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –æ–±—ä–µ–∫—Ç—É. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç.

## üß† –£—Ä–æ–≤–µ–Ω—å 1: –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö

**–ö–æ–¥-—É–±–∏–π—Ü–∞:**
```java
User user = null;
System.out.println(user.getName()); // NPE!
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- `User user` ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è **–±–∏—Ä–æ—á–∫–∞** —Å –Ω–∞–¥–ø–∏—Å—å—é ¬´user¬ª
- `= null` ‚Äî –≤–µ—à–∞–µ–º –±–∏—Ä–æ—á–∫—É **–≤ –ø—É—Å—Ç–æ–µ –º–µ—Å—Ç–æ**
- `user.getName()` ‚Äî –ø—ã—Ç–∞–µ–º—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏–º—è —Ç–∞–º, –≥–¥–µ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç

–ù–æ, –ø–æ–¥–æ–∂–¥–∏, –¥–∞–≤–∞–π —Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏–º –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ —ç—Ç–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
https://github.com/openjdk/jdk/blob/master/src/java.base/share/classes/java/lang/Exception.java

—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä—á–æ–∫—É
```
public class Exception extends Throwable {
```
–ù–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç RuntimeException (–Ω–µ–ø—Ä–æ–≤–µ—Ä—è–µ–º–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ)
–ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ throws clause
‚ö†Ô∏è —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –æ—Ç Throwable (—ç—Ç–æ –≤–∞–∂–Ω–æ) 
- NullPointerException –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç Throwable, –∏ –ø—Ä–∏—á–∏–Ω—ã –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è NPE –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ —Å–∞–º–æ–≥–æ Throwable. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —ç—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–æ:
- –û—Ç–ª–∏—á–Ω–æ, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –Ω–∞—à –≥–ª—É–±–æ–∫–∏–π —Ä–∞–∑–±–æ—Ä! –í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã, —á—Ç–æ –Ω–∞—á–∞—Ç—å –Ω—É–∂–Ω–æ —Å –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—Å—ë —Å—Ç—Ä–æ–∏—Ç—Å—è.

## **–£—Ä–æ–≤–µ–Ω—å 2: –ê–Ω–∞—Ç–æ–º–∏—è NullPointerException –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏ Java**

```java
// –í–æ—Ç —Ç–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ (—É–ø—Ä–æ—â–µ–Ω–Ω–æ):
java.lang.Object
    ‚îî‚îÄ‚îÄ java.lang.Throwable          // <- –í–°–ï –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏
            ‚îî‚îÄ‚îÄ java.lang.Exception  
                  ‚îî‚îÄ‚îÄ java.lang.RuntimeException  
                        ‚îî‚îÄ‚îÄ java.lang.NullPointerException
```

### **–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç: Throwable - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

**`Throwable` - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç:**

```java
public class Throwable {
    private String detailMessage;    // –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    private Throwable cause;         // –ü—Ä–∏—á–∏–Ω–∞ (–¥—Ä—É–≥–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ)
    private StackTraceElement[] stackTrace; // –°–¢–ï–ö –í–´–ó–û–í–û–í!
    // ... –∏ –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

## **üß© –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ NPE —Ñ–∏–∑–∏—á–µ—Å–∫–∏?**

1. **JVM –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é —Å `null`**
   - –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞: `null.someMethod()`
   - –î–æ—Å—Ç—É–ø –∫ –ø–æ–ª—é: `null.field`
   - –î–ª–∏–Ω–∞ –º–∞—Å—Å–∏–≤–∞: `null.length`

2. **JVM —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç `NullPointerException`**
   ```java
   // –ü—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ –≤–Ω—É—Ç—Ä–∏ JVM:
   NullPointerException npe = new NullPointerException();
   ```

3. **–ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤ (StackTrace)**
   - JVM "—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–µ—Ç" —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç–µ–∫–∞
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç: –∫–ª–∞—Å—Å, –º–µ—Ç–æ–¥, —Å—Ç—Ä–æ–∫—É –∫–æ–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑–æ–≤–∞

4. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ "–ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è" –ø–æ —Å—Ç–µ–∫—É**
   - –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–µ–≥–æ `catch (NullPointerException e)`
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∞–≤–∞—Ä–∏–π–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è

## **üîç –ó–∞–≥–ª—è–Ω–µ–º –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ NPE**

```java
public class NullPointerException extends RuntimeException {
    public NullPointerException() {
        super();
    }
    
    public NullPointerException(String s) {
        super(s);  // –ü–µ—Ä–µ–¥–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Throwable.detailMessage
    }
}
```

**–í–æ—Ç —á—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ!** –°–∞–º –∫–ª–∞—Å—Å `NullPointerException` –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø—É—Å—Ç–æ–π - –≤—Å—è –º–∞–≥–∏—è –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç `Throwable`:

- **`detailMessage`** - —Ö—Ä–∞–Ω–∏—Ç –Ω–∞—à–µ –∫–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- **`stackTrace`** - –º–∞—Å—Å–∏–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å—Ç–µ–∫–∞ –≤—ã–∑–æ–≤–æ–≤
- **`cause`** - –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É NPE (—Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

## **üí° –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å?**

```java
try {
    String str = null;
    str.length();
} catch (NullPointerException e) {
    System.out.println(e.getMessage()); // –ú–æ–∂–µ—Ç –±—ã—Ç—å null
    e.printStackTrace(); // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç stackTrace –∏–∑ Throwable
}
```

**–§–∏–∑–∏—á–µ—Å–∫–∏ –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ NPE:**
```
[ NullPointerException object ]
‚îú‚îÄ‚îÄ detailMessage = null (–∏–ª–∏ –Ω–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ)
‚îú‚îÄ‚îÄ cause = null
‚îú‚îÄ‚îÄ stackTrace = [–º–∞—Å—Å–∏–≤ StackTraceElement]
‚îÇ   ‚îú‚îÄ‚îÄ [0] {class: "Test", method: "main", line: 5}
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ ... –¥—Ä—É–≥–∏–µ —Å–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–ª—è
```

## **üéØ –ú–µ—Ö–∞–Ω–∏–∑–º "–±—Ä–æ—Å–∞–Ω–∏—è" –∏—Å–∫–ª—é—á–µ–Ω–∏—è**

–ö–æ–≥–¥–∞ JVM –≤–∏–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏—é —Å `null`:

```java
// –í –±–∞–π—Ç-–∫–æ–¥–µ –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
aload_1        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é 'str' –≤ —Å—Ç–µ–∫ (–∑–Ω–∞—á–µ–Ω–∏–µ = 0 = null)
invokevirtual  // –ü—ã—Ç–∞–µ–º—Å—è –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ -> JVM –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: 0? ‚Üí –ë–†–û–°–ê–ï–ú NPE!
```

**JVM –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –ù–ê–ú–ù–û–ì–û –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –µ—Å–ª–∏ –±—ã –º—ã –ø–∏—Å–∞–ª–∏:**
```java
if (str == null) {
    throw new NullPointerException();
}
```

## **üöÄ –ò—Ç–æ–≥ —É—Ä–æ–≤–Ω—è 2:**

1. **NPE –Ω–∞—Å–ª–µ–¥—É–µ—Ç –≤—Å—é –º–æ—â—å –æ—Ç `Throwable`** - —Å–æ–æ–±—â–µ–Ω–∏—è, —Å—Ç–µ–∫—Ç—Ä–µ–π—Å—ã, –ø—Ä–∏—á–∏–Ω—ã
2. **–°–æ–∑–¥–∞–Ω–∏–µ NPE - –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è** - —Å–±–æ—Ä —Å—Ç–µ–∫–∞, —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞
3. **JVM –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –Ω–∞—Ç–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤** - –æ—Ç—Å—é–¥–∞ –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫
4. **–ü—É—Å—Ç–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä NPE –Ω–µ –∑–Ω–∞—á–∏—Ç "–ø—Ä–æ—Å—Ç–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ"** - —Å—Ç–µ–∫—Ç—Ä–µ–π—Å –≤—Å—ë —Ä–∞–≤–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è

## **üî• –£—Ä–æ–≤–µ–Ω—å 3: –ö–∞–∫ JVM –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç NPE –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–π—Ç-–∫–æ–¥–∞**

### **üîç –°–º–æ—Ç—Ä–∏–º –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ JVM**

–î–∞–≤–∞–π —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∏ —Ä–∞–∑–±–µ—Ä—ë–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä:

```java
// NPEExample.java
public class NPEExample {
    public static void main(String[] args) {
        String str = null;
        int length = str.length(); // NPE –∑–¥–µ—Å—å!
    }
}
```

**–ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∏ —Å–º–æ—Ç—Ä–∏–º –±–∞–π—Ç-–∫–æ–¥:**
```bash
javac NPEExample.java
javap -c NPEExample
```

**–ü–æ–ª—É—á–∞–µ–º –±–∞–π—Ç-–∫–æ–¥:**
```
public static void main(java.lang.String[]);
  Code:
     0: aconst_null       // –ü–æ–º–µ—Å—Ç–∏—Ç—å null –≤ —Å—Ç–µ–∫
     1: astore_1          // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é str (slot 1)
     2: aload_1           // –ó–∞–≥—Ä—É–∑–∏—Ç—å str –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ —Å—Ç–µ–∫
     3: invokevirtual #2  // –í—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ String.length()
                          // ‚Üê NPE –ë–†–û–°–ê–ï–¢–°–Ø –ó–î–ï–°–¨!
     6: istore_2          // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ length
     7: return
```

## **üí• –ú–æ–º–µ–Ω—Ç –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è NPE**

–ö–ª—é—á–µ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è ‚Äî **`invokevirtual`**. –í–æ—Ç —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä–∏ JVM:

```c
// –ü—Å–µ–≤–¥–æ–∫–æ–¥ –∏–∑ hotspot/src/share/vm/interpreter/interpreterRuntime.cpp
void InterpreterRuntime::prepare_native_call(JavaThread* thread, Method* method) {
    // JVM –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: –æ–±—ä–µ–∫—Ç = null?
    if (receiver == NULL) {
        // –ë—Ä–æ—Å–∞–µ–º NPE —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º
        THROW(vmSymbols::java_lang_NullPointerException());
    }
}
```

## **üõ†Ô∏è –£—Ä–æ–≤–µ–Ω—å 4: –ì–ª—É–±–æ–∫–æ –≤ HotSpot JVM**

### **–ö–∞–∫ JVM –æ—Ç–ª–∏—á–∞–µ—Ç "0-—á–∏—Å–ª–æ" –æ—Ç "0-null"?**

**–û—Ç–≤–µ—Ç: –ù–ï –û–¢–õ–ò–ß–ê–ï–¢!** –ñ–µ–ª–µ–∑–æ –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ –±–∏—Ç—ã. –í—Å—è –º–∞–≥–∏—è ‚Äî –≤ **–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–π**.

```java
// –ü—Ä–∏–º–µ—Ä 1: int (–ø—Ä–∏–º–∏—Ç–∏–≤)
int x = 0;        // iconst_0 ‚Üí –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫!
System.out.println(x + 1); // iadd ‚Üí –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ —Å –Ω—É–ª—ë–º

// –ü—Ä–∏–º–µ—Ä 2: Object (—Å—Å—ã–ª–∫–∞)
Object obj = null; // aconst_null ‚Üí —Å—Å—ã–ª–∫–∞ = 0
obj.toString();    // invokevirtual ‚Üí –ß–ï–ö –ù–ê NULL!
```

### **–§–∏–∑–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ:**

```
// –î–ª—è invokevirtual:
if (reference_register == 0) {  // –ü—Ä–æ—Å—Ç–∞—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω—É–ª—ë–º!
    jump_to_exception_handler(NullPointerException);
} else {
    // –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞
}
```

## **üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ª–∞–¥–∫–∏ NPE**

**–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ NPE (–ø–æ –¥–∞–Ω–Ω—ã–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π):**

1. **–ú–µ—Ç–æ–¥ –Ω–∞ null-—Å—Å—ã–ª–∫–µ** ‚Äî 64%
   ```java
   null.toString();
   ```

2. **–î–æ—Å—Ç—É–ø –∫ –ø–æ–ª—é null-–æ–±—ä–µ–∫—Ç–∞** ‚Äî 23%
   ```java
   null.field;
   ```

3. **–î–ª–∏–Ω–∞ null-–º–∞—Å—Å–∏–≤–∞** ‚Äî 8%
   ```java
   null.length;
   ```

4. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ null** ‚Äî 5%
   ```java
   synchronized(null) {}
   ```

## **üéØ –£—Ä–æ–≤–µ–Ω—å 5: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ JVM**

### **Inlined NPE Checks**

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ JVM –¥–µ–ª–∞—é—Ç **–Ω–µ—è–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**:

```java
// –í–º–µ—Å—Ç–æ —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
if (obj == null) throw new NullPointerException();
obj.method();

// JVM –¥–µ–ª–∞–µ—Ç —ç—Ç–æ —á–µ—Ä–µ–∑:
// 1. –ó–∞–≥—Ä—É–∑–∫–∞ obj –≤ —Ä–µ–≥–∏—Å—Ç—Ä
// 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ —Å 0
// 3. –£—Å–ª–æ–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É NPE
```

### **Performance Impact**

**NPE –¥–µ—à–µ–≤–ª–µ, —á–µ–º –∫–∞–∂–µ—Ç—Å—è!** –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null –æ–±—ã—á–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ, –ø–æ—ç—Ç–æ–º—É:

- **–£—Å–ø–µ—à–Ω—ã–π —Å–ª—É—á–∞–π**: –ø–æ—á—Ç–∏ –Ω—É–ª–µ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
- **NPE —Å–ª—É—á–∞–π**: ~1000-5000 —Ç–∞–∫—Ç–æ–≤ (—Å–æ–∑–¥–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è + —Å–±–æ—Ä —Å—Ç–µ–∫–∞)

## **üîß –£—Ä–æ–≤–µ–Ω—å 6: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–±–æ—Ä —Å javap**

–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π —Å–ª—É—á–∞–π:

```java
public class ComplexNPE {
    public void process(User user) {
        String name = user.getProfile().getName().toUpperCase();
    }
}
```

**–ë–∞–π—Ç-–∫–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –í–°–ï –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ NPE:**
```
aload_1                 // –ó–∞–≥—Ä—É–∂–∞–µ–º 'user'
invokevirtual #4        // user.getProfile() ‚Üê NPE —Ç–æ—á–∫–∞ 1
invokevirtual #5        // .getName() ‚Üê NPE —Ç–æ—á–∫–∞ 2  
invokevirtual #6        // .toUpperCase() ‚Üê NPE —Ç–æ—á–∫–∞ 3
astore_2
```

## **üöÄ –£—Ä–æ–≤–µ–Ω—å 7: –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –≤ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö Java**

### **Java 14+: –ü–æ–º–æ—â—å –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ**

```java
// –°—Ç–∞—Ä–∞—è NPE:
Exception in thread "main" java.lang.NullPointerException
    at ComplexNPE.process(ComplexNPE.java:3)

// –ù–æ–≤–∞—è NPE (Java 14+ —Å -XX:+ShowCodeDetailsInExceptionMessages):
Exception in thread "main" java.lang.NullPointerException: 
    Cannot invoke "String.toUpperCase()" because the return value of 
    "Profile.getName()" is null
```

**–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** JVM —Ç–µ–ø–µ—Ä—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç **–∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –≤—ã–∑–æ–≤ –≤—ã–∑–≤–∞–ª NPE**.

## **‚ö° –ò—Ç–æ–≥ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–±–æ—Ä–∞:**

1. **`null` = –±—É–∫–≤–∞–ª—å–Ω–æ 0 –≤ —Ä–µ–≥–∏—Å—Ç—Ä–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞**
2. **JVM –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Å—ã–ª–∫–∏ –ø–µ—Ä–µ–¥ `invokevirtual`, `getfield`, `arraylength`**
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –Ω—É–ª—ë–º –Ω–∞ —É—Ä–æ–≤–Ω–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞**
4. **–î–æ—Ä–æ–≥–∞—è —á–∞—Å—Ç—å ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∏ —Å–±–æ—Ä stack trace**
5. **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ JVM –¥–µ–ª–∞—é—Ç —ç—Ç–æ –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ**

6. # üî• NullPointerException: –ü–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä –¥–æ –±–∞–π—Ç–æ–≤ - –í–°–ï –£–†–û–í–ù–ò

## **üöÄ –£—Ä–æ–≤–µ–Ω—å 8: NPE –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ memory model**

### **üí• Data Race –∏ NPE**

```java
public class ThreadNPE {
    private static Object resource = new Object();
    
    public static void main(String[] args) {
        // –ü–æ—Ç–æ–∫ 1
        new Thread(() -> {
            resource = null; // –í–û–¢ –û–ù - –£–ë–ò–ô–¶–ê!
        }).start();
        
        // –ü–æ—Ç–æ–∫ 2
        new Thread(() -> {
            try { Thread.sleep(10); } catch (InterruptedException e) {}
            System.out.println(resource.toString()); // NPE –ú–û–ñ–ï–¢ –ë–´–¢–¨, –ê –ú–û–ñ–ï–¢ –ò –ù–ï–¢!
        }).start();
    }
}
```

### **üîÑ Memory Barrier –∏ –≤–∏–¥–∏–º–æ—Å—Ç—å null**

**–ë–∞–π—Ç-–∫–æ–¥ –¥–ª—è –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è null:**
```
putstatic #2  // Field resource:Ljava/lang/Object;
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞:**
```java
// –ë–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ - –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –º–æ–∂–µ—Ç –ø–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏!
Thread 1:
Store Buffer: [resource = null] ‚Üí –ú–æ–∂–µ—Ç –∑–∞–¥–µ—Ä–∂–∞—Ç—å—Å—è!
Main Memory:  [resource = old_value] // –î—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫ –µ—â—ë –≤–∏–¥–∏—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é!

Thread 2:
–ß–∏—Ç–∞–µ—Ç –∏–∑ Main Memory ‚Üí –≤–∏–¥–∏—Ç —Å—Ç–∞—Ä—ã–π –æ–±—ä–µ–∫—Ç ‚Üí –Ω–µ—Ç NPE!
–ò–õ–ò
–ß–∏—Ç–∞–µ—Ç –ø–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞ ‚Üí –≤–∏–¥–∏—Ç null ‚Üí NPE!
```

### **üõ°Ô∏è volatile –ø—Ä–æ—Ç–∏–≤ NPE-–≥–æ–Ω–æ–∫**

```java
private static volatile Object resource = new Object();

// –ë–∞–π—Ç-–∫–æ–¥ —Ç–æ—Ç –∂–µ, –Ω–æ —Å–µ–º–∞–Ω—Ç–∏–∫–∞ –¥—Ä—É–≥–∞—è!
putstatic #2
// JVM –¥–æ–±–∞–≤–ª—è–µ—Ç memory barrier!
```

**–ß—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è:**
- **–ó–∞–ø—Ä–µ—Ç –ø–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è** –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å** –≤—Å–µ–º –ø–æ—Ç–æ–∫–∞–º
- **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ** - –ª–∏–±–æ –≤—Å–µ–≥–¥–∞ NPE, –ª–∏–±–æ –Ω–∏–∫–æ–≥–¥–∞

## **üéØ –£—Ä–æ–≤–µ–Ω—å 9: JIT-–∫–æ–º–ø–∏–ª—è—Ü–∏—è –∏ NPE –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**

### **üî• Inline-–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫**

```java
// –î–æ JIT-–∫–æ–º–ø–∏–ª—è—Ü–∏–∏:
for (int i = 0; i < 1000; i++) {
    if (obj != null) {     // ‚Üê –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–π —Ä–∞–∑!
        obj.doSomething();
    }
}

// –ü–æ—Å–ª–µ JIT-–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ (–ø—Å–µ–≤–¥–æ–∫–æ–¥ –Ω–∞ C++):
if (obj != null) {
    // HOT PATH: –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ obj –Ω–µ null
    for (int i = 0; i < 1000; i++) {
        obj.doSomething(); // ‚Üê –ë–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫!
    }
} else {
    // COLD PATH: —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥
    for (int i = 0; i < 1000; i++) {
        if (obj != null) {
            obj.doSomething();
        }
    }
}
```

### **‚ö° Speculative Optimization**

**JIT –¥–µ–ª–∞–µ—Ç —Å–º–µ–ª—ã–µ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è:**

```java
public void process(User user) {
    // JIT –∑–∞–º–µ—Ç–∏–ª, —á—Ç–æ 99.9% –≤—ã–∑–æ–≤–æ–≤ user != null
    // ‚Üí —É–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –í–°–¢–ê–í–õ–Ø–ï–¢ –ü–†–Ø–ú–û–ô –í–´–ó–û–í!
    user.getName(); // –ë–µ–∑ null-check!
    
    // –ù–æ –¥–æ–±–∞–≤–ª—è–µ—Ç "–ª–æ–≤—É—à–∫—É" (trap):
    // –ï—Å–ª–∏ user == null ‚Üí –æ—Ç–∫–∞—Ç –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä—É (deoptimization)!
}
```

### **üîç –ê—Å—Å–µ–º–±–ª–µ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å x86-64**

```asm
; –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null –≤ –∞—Å—Å–µ–º–±–ª–µ—Ä–µ
mov    rbx, [r13+0x18]   ; –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Å—ã–ª–∫—É –∏–∑ heap
test   rbx, rbx          ; –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –Ω—É–ª—ë–º (–±—ã—Å—Ç—Ä–µ–µ —á–µ–º cmp)
je     NULL_HANDLER      ; –ü–µ—Ä–µ—Ö–æ–¥ –µ—Å–ª–∏ zero (null)

; –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
call   [rbx+0x10]        ; –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ vtable[2]
```

## **üí• –£—Ä–æ–≤–µ–Ω—å 10: –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ Stack Trace**

### **üïµÔ∏è‚Äç‚ôÇÔ∏è –ö–∞–∫ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è Stack Trace**

```java
public class StackTraceDeepDive {
    public static void main(String[] args) {
        level1();
    }
    
    static void level1() { level2(); }
    static void level2() { level3(); }
    static void level3() { 
        String s = null;
        s.length(); // NPE –∑–¥–µ—Å—å!
    }
}
```

**Stack Trace —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —Ç–∞–∫:**
```java
// –í–Ω—É—Ç—Ä–∏ Throwable.fillInStackTrace():
public synchronized Throwable fillInStackTrace() {
    if (stackTrace != null || backtrace != null) {
        // 1. –ù–∞—Ç–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –¥–ª—è —Å–±–æ—Ä–∞ —Å—Ç–µ–∫–∞
        stackTrace = VMStackTrace.getStackTrace(this);
    }
    return this;
}
```

### **üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ StackTraceElement –≤ –ø–∞–º—è—Ç–∏**

```
[ StackTraceElement #1 ]
‚îú‚îÄ‚îÄ declaringClass: "StackTraceDeepDive" 
‚îú‚îÄ‚îÄ methodName:     "level3"
‚îú‚îÄ‚îÄ fileName:       "StackTraceDeepDive.java"
‚îú‚îÄ‚îÄ lineNumber:     12
‚îî‚îÄ‚îÄ classLoaderName: null

[ StackTraceElement #2 ]
‚îú‚îÄ‚îÄ declaringClass: "StackTraceDeepDive"
‚îú‚îÄ‚îÄ methodName:     "level2" 
‚îú‚îÄ‚îÄ fileName:       "StackTraceDeepDive.java"
‚îú‚îÄ‚îÄ lineNumber:     11
‚îî‚îÄ‚îÄ classLoaderName: null
```

### **‚è±Ô∏è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å Stack Trace**

**–°–±–æ—Ä stack trace - –°–ê–ú–ê–Ø –¥–æ—Ä–æ–≥–∞—è —á–∞—Å—Ç—å NPE!**

- **–ë–µ–∑ stack trace**: ~100 –Ω–∞–Ω–æ—Å–µ–∫—É–Ω–¥
- **–°–æ stack trace**: ~10-100 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥ (–≤ 1000 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ!)

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
```java
// –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (–û–ü–ê–°–ù–û!)
class FastNPE {
    private static final NullPointerException CACHED_NPE = 
        new NullPointerException();
    
    static {
        CACHED_NPE.setStackTrace(new StackTraceElement[0]); // –ü—É—Å—Ç–æ–π stack trace
    }
}
```

## **üîß –£—Ä–æ–≤–µ–Ω—å 11: NPE –≤ —Å–∏—Å—Ç–µ–º–∞—Ö –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**

### **üìà Metrics –∏ NPE-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**

```java
public class NPEMonitoring {
    private static final Counter npeCounter = Metrics.counter("npe.total");
    private static final Map<String, Counter> npeByMethod = new ConcurrentHashMap<>();
    
    public static void process(User user) {
        try {
            user.getName();
        } catch (NullPointerException e) {
            // –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫
            npeCounter.increment();
            npeByMethod.computeIfAbsent("process", k -> 
                Metrics.counter("npe.method." + k)).increment();
            
            // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
            logger.error("NPE in process with user: {}", user, e);
            throw e;
        }
    }
}
```

### **üéØ Production Debugging**

**–í–∫–ª—é—á–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:**
```bash
# JVM —Ñ–ª–∞–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ NPE
java -XX:+ShowCodeDetailsInExceptionMessages \
     -XX:+StackTraceInThrowable \
     -XX:MaxJavaStackTraceDepth=100 \
     -Xlog:exceptions=info:file=exceptions.log \
     MyApp
```

## **‚ö° –£—Ä–æ–≤–µ–Ω—å 12: NPE –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

### **üõ°Ô∏è NPE –∫–∞–∫ —É—è–∑–≤–∏–º–æ—Å—Ç—å**

```java
// –ü—Ä–∏–º–µ—Ä: –æ–±—Ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
public class SecurityCheck {
    private User admin;
    
    public boolean isAdmin() {
        return admin != null && admin.isAdmin();
    }
    
    public void dangerousOperation() {
        if (isAdmin()) {
            // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è
            deleteDatabase();
        }
    }
}

// –ê—Ç–∞–∫–∞: –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
Thread 1: if (isAdmin()) { // admin != null ‚Üí true
// –í —ç—Ç–æ –≤—Ä–µ–º—è Thread 2: securityCheck.admin = null;
Thread 1: dangerousOperation(); // NPE, –Ω–æ –±–∞–∑–∞ —É–∂–µ —É–¥–∞–ª–µ–Ω–∞!
```

### **üîí –ó–∞—â–∏—Ç–∞ –æ—Ç NPE-–∞—Ç–∞–∫**

```java
// 1. Final –ø–æ–ª—è
private final User admin; // –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ –∏–Ω–∏—Ç–∞

// 2. –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏
public void dangerousOperation() {
    User localAdmin = this.admin; // –ö–æ–ø–∏—Ä—É–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
    if (localAdmin != null && localAdmin.isAdmin()) {
        deleteDatabase(); // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ–ø–∏—é
    }
}

// 3. Synchronized –±–ª–æ–∫–∏
public synchronized void dangerousOperation() {
    if (isAdmin()) {
        deleteDatabase();
    }
}
```

## **üéØ –£—Ä–æ–≤–µ–Ω—å 13: NPE –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö**

### **üöÄ Spring –∏ NPE**

```java
@Component
public class UserService {
    @Autowired
    private UserRepository userRepository; // –ú–æ–∂–µ—Ç –±—ã—Ç—å null –±–µ–∑ @Autowired!
    
    // Spring –∏—Å–ø–æ–ª—å–∑—É–µ—Ç reflection - NPE –≤ runtime!
    public User findUser(String id) {
        return userRepository.findById(id); // NPE –µ—Å–ª–∏ –Ω–µ –∏–Ω–∂–µ–∫—Ç–Ω—É–ª–æ—Å—å!
    }
}
```

**–ó–∞—â–∏—Ç–∞ –≤ Spring:**
```java
// 1. Constructor injection (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
@Component
public class UserService {
    private final UserRepository userRepository;
    
    public UserService(UserRepository userRepository) {
        this.userRepository = Objects.requireNonNull(userRepository);
    }
}

// 2. @NonNull –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
public User findUser(@NonNull String id) {
    // –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏ IDE –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—Ç –æ –≤–æ–∑–º–æ–∂–Ω–æ–º NPE
    return userRepository.findById(id);
}
```

### **üì± Android –∏ NPE**

```java
// –¢–∏–ø–∏—á–Ω–∞—è Android NPE
public class MainActivity extends Activity {
    private TextView textView;
    
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        
        textView = findViewById(R.id.text_view);
        // –ï—Å–ª–∏ text_view –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ layout ‚Üí textView = null
        
        textView.setText("Hello"); // NPE!
    }
}
```

## **üîÆ –£—Ä–æ–≤–µ–Ω—å 14: –ë—É–¥—É—â–µ–µ NPE - Project Valhalla –∏ –¥—Ä—É–≥–∏–µ**

### **üöÄ Value Types (Project Valhalla)**

```java
// –ë—É–¥—É—â–µ–µ: –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å null!
primitive class Point {
    int x, y;
    Point(int x, int y) { this.x = x; this.y = y; }
}

Point p = new Point(1, 2);
Point nullPoint = null; // –ö–û–ú–ü–ò–õ–Ø–¶–ò–û–ù–ù–ê–Ø –û–®–ò–ë–ö–ê!

// NPE –∏—Å—á–µ–∑–∞–µ—Ç –¥–ª—è value types!
```

### **ü¶â Null-–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–∏–ø—ã (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)**

```java
// –í–æ–∑–º–æ–∂–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –±—É–¥—É—â–µ–≥–æ
public String process(User! user) {  // ! = not-null
    return user.getName(); // –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –±–µ–∑ NPE!
}

public String process(User? user) {  // ? = nullable  
    return user?.getName() ?? "default"; // Safe calls like Kotlin
}
```

## **üéØ –ò–¢–û–ì –í–°–ï–• –£–†–û–í–ù–ï–ô:**

1. **‚öôÔ∏è –§–∏–∑–∏—á–µ—Å–∫–∏**: `null` = 0 –≤ –ø–∞–º—è—Ç–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ = —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å 0
2. **üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: JIT –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç, stack trace - –¥–æ—Ä–æ–≥–æ
3. **üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: NPE –º–æ–∂–µ—Ç –±—ã—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç—å—é
4. **üîß –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å**: data race –¥–µ–ª–∞–µ—Ç NPE –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º
5. **üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: NPE-–º–µ—Ç—Ä–∏–∫–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
6. **üéØ –ë—É–¥—É—â–µ–µ**: Value types –∏ null-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–Ω–∏—á—Ç–æ–∂–∞—Ç NPE

## **üíé –§–ò–ù–ê–õ–¨–ù–´–ô –í–´–í–û–î:**

**NPE - —ç—Ç–æ –Ω–µ –±–∞–≥, —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–æ–≤ Java, –æ—Ç—Ä–∞–∂–∞—é—â–µ–µ —Ñ–∏–ª–æ—Å–æ—Ñ–∏—é "–∫–æ–¥ –¥–æ–ª–∂–µ–Ω –ø–∞–¥–∞—Ç—å —Ä–∞–Ω–æ –∏ —è–≤–Ω–æ". –ü–æ–Ω–∏–º–∞–Ω–∏–µ NPE –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö - –ø—É—Ç—å –∫ –Ω–∞–ø–∏—Å–∞–Ω–∏—é —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ, –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞.**
